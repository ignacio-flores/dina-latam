{smcl}
{txt}{sf}{ul off}{.-}
      name:  {res}<unnamed>
       {txt}log:  {res}E:\Users\i.flores.PSE\Documents\GitHub\dina-latam\output/ineqstats/log/pch_raw_28Aug2025.smcl
  {txt}log type:  {res}smcl
 {txt}opened on:  {res}28 Aug 2025, 15:32:06
step: raw
{txt}{hline 79}
                               INEQSTATS Settings
{hline 79}
Areas (11):{res} COL ARG PER URY CRI ECU CHL BRA SLV MEX DOM
{txt}Period: {res}2000{txt}-{res}2023
{txt}Weight: {res}_fep{txt} 
Unit: {res}pch
{txt}Decomposing by: {res}pch_pre_wag pch_pre_pen pch_pre_cap pch_pre_imp pch_pre_mix
{txt}Survey type: {res}raw
{txt}edad/age: {res}0
{txt}{hline 79}
{res}{txt}ineqstats (06a): COL 2002 saved at 15:32:39.
{res}{txt}ineqstats (06a): COL 2003 saved at 15:33:13.
{res}{txt}ineqstats (06a): COL 2004 saved at 15:33:51.
{res}{txt}ineqstats (06a): COL 2005 saved at 15:34:30.
{res}{txt}ineqstats (06a): COL 2008 saved at 15:35:22.
{res}{txt}ineqstats (06a): COL 2009 saved at 15:36:14.
{res}{txt}ineqstats (06a): COL 2010 saved at 15:37:07.
{res}{txt}ineqstats (06a): COL 2011 saved at 15:38:01.
{res}{txt}ineqstats (06a): COL 2012 saved at 15:38:53.
{res}{txt}ineqstats (06a): COL 2013 saved at 15:39:44.
{res}{txt}ineqstats (06a): COL 2014 saved at 15:40:36.
{res}{txt}ineqstats (06a): COL 2015 saved at 15:41:27.
{res}{txt}ineqstats (06a): COL 2016 saved at 15:42:19.
{res}{txt}ineqstats (06a): COL 2017 saved at 15:43:06.
{res}{txt}ineqstats (06a): COL 2018 saved at 15:43:55.
{res}{txt}ineqstats (06a): COL 2019 saved at 15:44:43.
{res}{txt}ineqstats (06a): COL 2020 saved at 15:45:31.
{res}{txt}ineqstats (06a): COL 2021 saved at 15:46:26.
{res}{txt}ineqstats (06a): COL 2022 saved at 15:47:23.
{res}{txt}ineqstats (06a): COL 2023 saved at 15:48:15.
{res}{txt}ineqstats (06a): ARG 2000 saved at 15:48:25.
{res}{txt}ineqstats (06a): ARG 2001 saved at 15:48:37.
{res}{txt}ineqstats (06a): ARG 2002 saved at 15:48:49.
{res}{txt}ineqstats (06a): ARG 2003 saved at 15:48:56.
{res}{txt}ineqstats (06a): ARG 2004 saved at 15:49:07.
{res}{txt}ineqstats (06a): ARG 2005 saved at 15:49:16.
{res}{txt}ineqstats (06a): ARG 2006 saved at 15:49:27.
{res}{txt}ineqstats (06a): ARG 2007 saved at 15:49:39.
{res}{txt}ineqstats (06a): ARG 2008 saved at 15:49:56.
{res}{txt}ineqstats (06a): ARG 2009 saved at 15:50:10.
{res}{txt}ineqstats (06a): ARG 2010 saved at 15:50:22.
{res}{txt}ineqstats (06a): ARG 2011 saved at 15:50:42.
{err}{hline 2}Break{hline 2}
{txt}{search r(1), local:r(1);}

end of do-file
{err}{hline 2}Break{hline 2}
{txt}{search r(1), local:r(1);}

end of do-file

{err}{hline 2}Break{hline 2}
{txt}{search r(1), local:r(1);}

{com}. do "E:\Users\i.flores.PSE\Documents\GitHub\dina-latam\code\Stata\00-run-everything.do"
{txt}
{com}. 
. ///////////////////////////////////////////////////////////////////////////////
> //                                                                                                                                                       //
. //                                                                                                                                                       //
. //  MORE UNEQUAL OR NOT AS RICH? The Missing Half of Latin American Income       //
. //                                      De Rosa, Flores & Morgan (2022)                                          //
. //                                  Goal: Runs every dofile in the project                                       //
. //                                                                                                                                                   //
. ///////////////////////////////////////////////////////////////////////////////
> 
. //general settings 
. macro drop _all 
{txt}
{com}. clear all 
{res}{txt}
{com}. 
. *ssc install gtools mipolate quandl xls2dta sgini  wid  kountry genstack egenmore ereplace jsonio distinct ineqdeco 
. // search dm88_1 (to download renvars) 
. // net install github, from("https://haghish.github.io/github/")
. // github install haghish/rcall
. 
. //list codes 
. ***********************************************************************
. *global do_codes1 " "01a" "01b" "01c" "01d" "01e" "01f" "01g" " 
. *global do_codes2 " "02a" "02c" "02d" "02e" " //"02b"
. *global do_codes3 " "03a" "03b" "03c" "03d" "03e" " 
. *global do_codes4 " "04a" "04b" "04c" " 
. *global do_codes5   " "05a" "05b" "05c" "05d" "  
. global do_codes6  " "06a" " //"06b" "06c"
{txt}
{com}. *global do_codes7  " "07a" "07b" "07c" "07d" " 
. global last_code = 6
{txt}
{com}. ***********************************************************************
. 
. //report and save start time 
. local start_t "$S_DATE at $S_TIME"
{txt}
{com}. di as result "Started running everything working `start_t'"
{res}Started running everything working 28 Aug 2025 at 16:01:16
{txt}
{com}. 
. //prepare list of do-files 
. forvalues n = 1/$last_code {c -(}
{txt}  2{com}. 
.         //get do-files' name 
.         foreach docode in ${c -(}do_codes`n'{c )-} {c -(} 
{txt}  3{com}.                         
.                 local do_name : dir "code/Stata/." files "`docode'*.do" 
{txt}  4{com}.                 local do_name = subinstr(`do_name', char(34), "", .)
{txt}  5{com}.                 global doname_`docode' "`do_name'"
{txt}  6{com}.         {c )-}
{txt}  7{com}. {c )-}       
{txt}
{com}. 
. //loop over all files  
. forvalues n = 1/$last_code {c -(}
{txt}  2{com}.         foreach docode in ${c -(}do_codes`n'{c )-} {c -(}
{txt}  3{com}.                 
.                 *********************
.                 do code/Stata/${c -(}doname_`docode'{c )-}
{txt}  4{com}.                 *********************
.                 
.                 //record time
.                 global do_endtime_`docode' " - ended $S_DATE at $S_TIME"
{txt}  5{com}.                 
.                 //remember work plan
.                 di as result "{c -(}hline 70{c )-}" 
{txt}  6{com}.                 di as result "list of files to run, started `start_t'"
{txt}  7{com}.                 di as result "{c -(}hline 70{c )-}"
{txt}  8{com}.                 forvalues x = 1/$last_code {c -(}
{txt}  9{com}.                         di as result "Stage nÂº`x'"
{txt} 10{com}.                         foreach docode2 in ${c -(}do_codes`x'{c )-} {c -(}
{txt} 11{com}.                                 di as text "  * " "${c -(}doname_`docode2'{c )-}" _continue
{txt} 12{com}.                                 di as text " ${c -(}do_endtime_`docode2'{c )-}"
{txt} 13{com}.                         {c )-}
{txt} 14{com}.                         if `x' == ${c -(}last_code{c )-} di as result "{c -(}hline 70{c )-}"        
{txt} 15{com}.                 {c )-}
{txt} 16{com}.         {c )-}
{txt} 17{com}. {c )-}
{txt}
{com}. ////////////////////////////////////////////////////////////////////////////////
> //
. //                                              Title: INEQUALITY STATISTICS - DATA 
. //                       Authors: Mauricio DE ROSA, Ignacio FLORES, Marc MORGAN 
. //                                                                      Year: 2020
. //
. //                      Description:
. //                      Apply the 'ineqstats' program to various steps of our correction
. //                      and save results for analysis. It provides income shares, ginis, 
. //                      , theil, sginis and income composition for every country-year 
. //
. ///////////////////////////////////////////////////////////////////////////////
> 
. clear all 
{res}{txt}
{com}. 
. //General settings -------------------------------------------------------------
. 
. //get list of paths 
. global aux_part " "preliminary" " 
{txt}
{com}. qui do "code/Stata/auxiliar/aux_general.do"
{txt}
{com}. 
. //find program
. sysdir set PERSONAL "code/Stata/ado/ineqstats_ado/." 
{txt}
{com}. 
. //Run ineqstats program --------------------------------------------------------
. 
. foreach step in $all_steps {c -(}
{txt}  2{com}. 
.         local date "$S_DATE"
{txt}  3{com}.         local date = subinstr("`date'", " ", "", .)
{txt}  4{com}.         
.         //get short name of step
.         local s = substr("`step'", 1, 3)
{txt}  5{com}.         
.         //normie locals
.         local type "`step'"
{txt}  6{com}.         local weight "_weight"
{txt}  7{com}.         local bfm "" 
{txt}  8{com}.         
.         //special-cases
.         if inlist("`step'", "raw", "por") local weight "_fep"
{txt}  9{com}.         if ("`step'" == "raw") local ext "_svy_y" 
{txt} 10{com}.         else local ext ""
{txt} 11{com}.         if inlist("`step'", "bfm${c -(}ext{c )-}_pre") local bfm_`step' "bfm"
{txt} 12{com}.         if inlist("`step'", "rescaled", "uprofits", ///
>                 "natinc", "pod", "pon", "psp") {c -(}
{txt} 13{com}.                 local type "bfm${c -(}ext{c )-}_pre"
{txt} 14{com}.         {c )-}
{txt} 15{com}.         
.         //create main folders 
.         local dirpath "output/ineqstats"
{txt} 16{com}.         mata: st_numscalar("exists", direxists(st_local("dirpath")))
{txt} 17{com}.         if (scalar(exists) == 0) {c -(}
{txt} 18{com}.                 mkdir "`dirpath'"
{txt} 19{com}.                 display "Created directory: `dirpath'"
{txt} 20{com}.         {c )-}
{txt} 21{com}.         //create main folders 
.         local dirpath "output/ineqstats/log"
{txt} 22{com}.         mata: st_numscalar("exists", direxists(st_local("dirpath")))
{txt} 23{com}.         if (scalar(exists) == 0) {c -(}
{txt} 24{com}.                 mkdir "`dirpath'"
{txt} 25{com}.                 display "Created directory: `dirpath'"
{txt} 26{com}.         {c )-}
{txt} 27{com}.         
.         //statistical units
.         global units " $units_06a "
{txt} 28{com}.         foreach unit in $units {c -(}
{txt} 29{com}. 
.                 cap log close
{txt} 30{com}.                 log using "output/ineqstats/log/`unit'_`step'_`date'.smcl", replace 
{txt} 31{com}.                 if inlist("`unit'", "ind", "esn") local age 20
{txt} 32{com}.                 if inlist("`unit'", "pch") local age 0
{txt} 33{com}.                 if inlist("`unit'", "act") local age 20 65
{txt} 34{com}.                 
.                 //loop over country groups      
.                 di as result "step: `step'"
{txt} 35{com}.                 
.                 //call program  
.                  ineqstats summarize, `bfm_`step'' ///
>                         svypath("intermediary_data/microdata/bfm${c -(}ext{c )-}_pre") edad(`age') ///
>                         type(`type') time($first_y $last_y) area(${c -(}all_countries{c )-}) ///
>                         export("output/ineqstats/ineqstats_`step'_`unit'.xlsx") ///
>                         weight(`weight') dec(${c -(}`unit'_`s'_norm{c )-}) ///
>                         unit(`unit')  /*smoothtop*/
{txt} 36{com}.                 log close 
{txt} 37{com}.         {c )-}
{txt} 38{com}. {c )-}       
{res}{smcl}
{res}{sf}{ul off}